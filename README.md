# Real-time multi-object tracking using Yolov8 with OCSORT

<div align="center">
  <p>
  <img src="trackers/strongsort/results/track_all_1280_025conf.gif" width="700"/>
  </p>
</div>

## Introduction

This repository contains a highly configurable two-stage-tracker that adjusts to different deployment scenarios. It can jointly perform multiple object tracking and instance segmentation (MOTS). The detections generated by [YOLOv8](https://github.com/ultralytics/ultralytics), a family of object detection architectures and models pretrained on the [COCO](https://arxiv.org/abs/1405.0312) dataset, are passed to the tracker of your choice. Supported ones at the moment are: [DeepOCSORT](https://arxiv.org/abs/2302.11813), [OCSORT](https://github.com/noahcao/OC_SORT), [StrongSORT](https://github.com/dyhBUPT/StrongSORT)[](https://arxiv.org/abs/2202.13514), [ByteTrack](https://github.com/ifzhang/ByteTrack) and [BoTSORT](https://arxiv.org/abs/2206.14651), . They can track any object that your Yolov8 model was trained to detect.

## Installation

```
pip install -r requirements.txt
```

## Tracking

```bash
$ python track.py
```

- Detection mode

  ```bash
  $ python track.py --yolo-weights yolov8n.pt      # bboxes only
                                  yolov8n-seg.pt  # bboxes + segmentation masks
  ```

- Tracking methods

  ```bash
  $ python track.py --tracking-method ocsort
                                      deepocsort
                                      strongsort
                                      bytetrack
                                      botsort
  ```
  
- Tracking sources

  Tracking can be run on most video formats

  ```bash
  $ python track.py --source 0                               # webcam
                            img.jpg                         # image
                            vid.mp4                         # video
                            path/                           # directory
                            path/*.jpg                      # glob
                            'https://youtu.be/Zgi9g1ksQHc'  # YouTube
  ```


- Select Yolov8 model

  There is a clear trade-off between model inference speed and overall performance. In order to make it possible to fulfill your inference speed/accuracy needs you can select a Yolov8 family model for automatic download. You can also select image size of 640 or 1280.

  ```bash
  $ python track.py --source 0 --yolo-weights yolov8n.pt --img 640
                                              yolov8s.pt
                                              yolov8m.pt
                                              yolov8l.pt 
                                              yolov8x.pt --img 1280
                                              ...
  ```
  
- Filter tracked classes

  By default the tracker tracks all MS COCO classes.
  If you want to track a subset of the classes that you model predicts, add their corresponding index after the classes flag.

  ```bash
  python track.py --source 0 --yolo-weights yolov8s.pt --classes 16 17  # Track cats and dogs, only
  ```

  [Here](https://tech.amikelive.com/node-718/what-object-categories-labels-are-in-coco-dataset/) is a list of all the possible objects that a Yolov8 model trained on MS COCO can detect. Notice that the indexing for the classes in this repo starts at zero